function isUrlValid(e){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)}const location_buttons=document.querySelectorAll(".events-btn-location");function setUpLocationListeners(e){if("physical_location"==e){let e=document.getElementById("location");e.addEventListener("change",()=>{"new"==e.value?document.getElementById("new-location-fields").style.display="block":document.getElementById("new-location-fields").style.display="none"}),"new"==e.value?document.getElementById("new-location-fields").style.display="block":document.getElementById("new-location-fields").style.display="none"}else if("virtual_location"==e){let e=document.getElementById("v-location");e.addEventListener("change",()=>{"new"==e.value?document.getElementById("new-v-location-fields").style.display="block":document.getElementById("new-v-location-fields").style.display="none"}),"new"==e.value?document.getElementById("new-v-location-fields").style.display="block":document.getElementById("new-v-location-fields").style.display="none"}}location_buttons.forEach(a=>{a.addEventListener("click",()=>{if("true"===a.dataset.add){a.dataset.add="false",a.innerHTML=a.innerHTML.replace("Add","Remove"),a.classList.remove("dcf-btn-primary"),a.classList.add("dcf-btn-secondary"),document.querySelector(`input[type='hidden'][name='${a.dataset.controls}_check']`).value="1";const t=document.getElementById(a.dataset.controls+"_template");var e=t.content.cloneNode("true");document.getElementById(a.dataset.controls+"_container").append(e),setUpLocationListeners(a.dataset.controls)}else a.dataset.add="true",a.innerHTML=a.innerHTML.replace("Remove","Add"),a.classList.remove("dcf-btn-secondary"),a.classList.add("dcf-btn-primary"),document.querySelector(`input[type='hidden'][name='${a.dataset.controls}_check']`).value="0",document.getElementById(a.dataset.controls+"_container").innerHTML=""})});const google_microdata_button=document.getElementById("google-microdata-button");function testMicrodata(e=!0){let t=!0;const a=document.getElementById("google-microdata-button"),n=document.getElementById("google-microdata-modal-output");let i="";var o,l,r,d=document.getElementById("title"),u=document.getElementById("start-date"),s=document.getElementById("physical_location_check"),c=document.getElementById("virtual_location_check");""==d.value&&(e&&(i+="<li>Missing title</li>"),t=!1),""==u.value&&(e&&(i+="<li>Missing start date</li>"),t=!1),"0"==s.value&&"0"==c.value&&(e&&(i+="<li>Missing a location (Could be virtual, physical, or both)</li>"),t=!1),"1"==s.value&&("new"==(d=document.getElementById("location")).value?(u=document.getElementById("location-name"),s=document.getElementById("location-address-1"),o=document.getElementById("location-city"),l=document.getElementById("location-state"),r=document.getElementById("location-zip"),""==u.value&&(e&&(i+="<li>Missing a location name</li>"),t=!1),""==s.value&&(e&&(i+="<li>Missing a location address</li>"),t=!1),""==o.value&&(e&&(i+="<li>Missing a location city</li>"),t=!1),""==l.value&&(e&&(i+="<li>Missing a location state</li>"),t=!1),""==r.value&&(e&&(i+="<li>Missing a location zip</li>"),t=!1)):"true"!=d.options[d.selectedIndex].dataset.microdata&&(e&&(i+="<li>The Location you selected does not meet the requirements for google microdata</li>"),t=!1)),"1"==c.value&&"new"==document.getElementById("v-location").value&&(u=document.getElementById("new-v-location-name"),s=document.getElementById("new-v-location-url"),""==u.value&&(e&&(i+="<li>Missing a virtual location name</li>"),t=!1),""==s.value&&(e&&(i+="<li>Missing a virtual location URL</li>"),t=!1),""==s.value||isUrlValid(s.value)||(e&&(i+="<li>Virtual location's URL is invalid</li>"),t=!1)),t?(e&&(n.innerHTML="<span class='dcf-bold'>Your event is fulfilling all google's requirements</span>"),a.innerHTML="Your event does reach google microdata requirements",a.style.backgroundColor="var(--bg-brand-zeta)",a.style.borderColor="var(--bg-brand-zeta)"):(e&&(n.innerHTML="<span class='dcf-bold'>Your event is missing these requirements:</span> <ul>"+i+"</ul>"),a.innerHTML="! Your event does not reach google microdata requirements !",a.style.backgroundColor="var(--bg-brand-eta)",a.style.borderColor="var(--bg-brand-eta)")}document.addEventListener("ModalOpenEvent_"+google_microdata_button.dataset.togglesModal,()=>{testMicrodata(!0)}),document.addEventListener("input",e=>{testMicrodata(!1)}),document.getElementById("start-date").addEventListener("change",e=>{testMicrodata(!1)}),require(["jquery","wdn"],function(l,e){e.initializePlugin("datepickers"),e.initializePlugin("modals"),l("#recurring").change(function(){this.checked&&setRecurringOptions(l("#start-date"),l("#monthly-group"),recurringType)}),l("#start-date").change(function(){setRecurringOptions(l(this),l("#monthly-group"),recurringType)}),setRecurringOptions(l("#start-date"),l("#monthly-group")),l("#recurring-type").val(recurringType),l("input[type=radio][name=send_to_main]").change(function(){"on"==this.value?l(".required-for-main-calendar").show():"off"==this.value&&l(".required-for-main-calendar").hide()}),l("#create-event-form").submit(function(e){var t,a,n=[],i=(""!=l("#title").val()&&""!=l("#start-date").val()||(""==l("#title").val()&&notifier.mark_input_invalid(l("#title")),""==l("#start-date").val()&&notifier.mark_input_invalid(l("#start-date")),n.push('<a href="#title">Title</a>, and <a href="#start-date">start date</a> are required.')),"1"!=l("#physical_location_check").val()&&"1"!=l("#virtual_location_check").val()&&n.push('A <a href="#physical_location_add_button">physical</a> or <a href="virtual_location_add_button">virtual</a> location must be provided'),new Date(l("#start-date").val())),o=(""!=l("#start-date").val()&&""!=l("#end-date").val()&&(o=new Date(l("#end-date").val()),t=l("#start-time-am-pm-pm").is(":checked")?"pm":"am",a=""!=l("#start-time-hour").val()?parseInt(l("#start-time-hour").val())%12:0,a="pm"==t?a+12:a,t=""!=l("#start-time-minute").val()?parseInt(l("#start-time-minute").val()):0,i.setHours(a),i.setMinutes(t),a=l("#end-time-am-pm-pm").is(":checked")?"pm":"am",t=""!=l("#end-time-hour").val()?parseInt(l("#end-time-hour").val())%12:0,t="pm"==a?t+12:t,a=""!=l("#end-time-minute").val()?parseInt(l("#end-time-minute").val()):0,o.setHours(t),o.setMinutes(a),o<i&&(notifier.mark_input_invalid(l("#end-date")),n.push('Your <a href="#end-date">end date/time</a> must be on or after the <a href="#start-date">start date/time</a>.'))),""!=l("#start-date").val()&&l("#recurring").is(":checked")&&(""!=l("#recurring-type").val()&&""!=l("#recurs-until-date").val()||(""==l("#recurring-type").val()&&notifier.mark_input_invalid(l("#recurring-type")),""==l("#recurs-until-date").val()&&notifier.mark_input_invalid(l("#recurs-until-date")),n.push('Recurring events require a <a href="#recurring-type">recurring type</a> and <a href="#recurs-until-date">date</a> that they recur until.')),""!=l("#end-date").val()&&(t=new Date(l("#start-date").val()),a=new Date(l("#end-date").val()),t&&a&&t.getDate()!=a.getDate()&&n.push("A recurring event instance start and end date must be the same day. If you need multiple multi-day (ongoing) occurrences, you must define them as separate datetime instances.")),i.setHours(0),i.setMinutes(0),new Date(l("#recurs-until-date").val())<i&&(notifier.mark_input_invalid(l("#recurs-until-date")),n.push('The <a href="#recurs-until-date">"recurs until date"</a> must be on or after the start date.'))),"1"==l("#physical_location_check").val()&&("new"==l("#location").val()&&""==l("#location-name").val()&&(notifier.mark_input_invalid(l("#location-name")),n.push('You must give your new location a <a href="#location-name">name</a>.')),"new"==l("#location").val()&&""==l("#location-address-1").val()&&(notifier.mark_input_invalid(l("#location-address-1")),n.push('You must give your new location a <a href="#location-address-1">address</a>.')),"new"==l("#location").val()&&""==l("#location-city").val()&&(notifier.mark_input_invalid(l("#location-city")),n.push('You must give your new location a <a href="#location-city">city</a>.')),"new"==l("#location").val()&&""==l("#location-state").val()&&(notifier.mark_input_invalid(l("#location-state")),n.push('You must give your new location a <a href="#location-state">state</a>.')),"new"==l("#location").val()&&""==l("#location-zip").val()&&(notifier.mark_input_invalid(l("#location-zip")),n.push('You must give your new location a <a href="#location-zip">zip</a>.')),"new"!=l("#location").val()||""===l("#location-webpage").val()||isUrlValid(l("#location-webpage").val())||(notifier.mark_input_invalid(l("#location-webpage")),n.push('<a href="#location-webpage"> Location URL</a> is not a valid URL.'))),"1"==l("#virtual_location_check").val()&&("new"==l("#v-location").val()&&""==l("#new-v-location-name").val()&&(notifier.mark_input_invalid(l("#new-v-location-name")),n.push('You must give your new virtual location a <a href="#new-v-location-name">name</a>.')),"new"==l("#v-location").val()&&""==l("#new-v-location-url").val()?(notifier.mark_input_invalid(l("#new-v-location-url")),n.push('You must give your new virtual location a <a href="#new-v-location-url">URL</a>.')):"new"!=l("#v-location").val()||""===l("#new-v-location-url").val()||isUrlValid(l("#new-v-location-url").val())||(notifier.mark_input_invalid(l("#new-v-location-url")),n.push('<a href="#new-v-location-url">Virtual Location URL</a> is not a valid URL.'))),void 0===l('input[name="send_to_main"]:checked').val()?(notifier.mark_input_invalid(l("#send_to_main_on")),n.push('<a href="#send_to_main">Consider for main calendar</a> is required.')):"on"===l('input[name="send_to_main"]:checked').val()&&(""==l("#description").val().trim()&&(notifier.mark_input_invalid(l("#description")),n.push('<a href="#description">Description</a> is required when event is considered for main calendar.')),""==l("#contact-name").val().trim()&&(notifier.mark_input_invalid(l("#contact-name")),n.push('<a href="#contact-name">Contact Name</a> is required when event is considered for main calendar.')),""==l("#cropped-image-data").val().trim()&&""==l("#imagedata").val().trim()&&(notifier.mark_input_invalid(l("#imagedata")),n.push('<a href="#imagedata">Image</a> is required when event is considered for main calendar.'))),l("#website").val());""==o||isUrlValid(o)||(notifier.mark_input_invalid(l("#website")),n.push('<a href="#website">Event Website</a> is not a valid URL.')),0<n.length&&(e.preventDefault(),notifier.alert("Sorry! We couldn't create your event","<ul><li>"+n.join("</li><li>")+"</li></ul>"))})});